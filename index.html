<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pagal Anabia the Witch</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- 🔮 Dark looping video background -->
  <video autoplay muted loop id="bg-video">
    <source src="https://cdn.pixabay.com/video/2021/09/13/88716-601105122_large.mp4" type="video/mp4">
  </video>

  <audio id="bg-music" loop>
    <source src="https://cdn.pixabay.com/audio/2021/11/02/audio_2a1e95c6a9.mp3" type="audio/mpeg" />
  </audio>

  <audio id="thunder">
    <source src="https://cdn.pixabay.com/audio/2023/03/15/audio_4ee8e7f5d2.mp3" type="audio/mpeg" />
  </audio>

  <div class="flash" id="flash"></div>

  <div class="container">
    <h1>Pagal Anabia the Witch</h1>
    <p id="story">
      In a forgotten forest covered in endless fog, there lived a strange witch — Pagal Anabia.  
      Her laughter echoed through the darkness, twisting the trees and waking shadows that should have slept forever.  
      She mixed potions that glowed like fireflies and whispered to the wind as if it were alive.  
      But one night, as the moon turned red, her spell went wrong.  
      The ground trembled, the fire died, and her own voice cursed her name.  
      With her last breath, she smiled and whispered, "Gagar will come back..."  
      Then, silence — forever.
    </p>

    <div class="buttons">
      <button id="playBtn">🎧 Play Music</button>
      <button id="speakBtn">🔊 Read Story</button>
    </div>
  </div>

  <script>
    const bgMusic = document.getElementById("bg-music");
    const thunder = document.getElementById("thunder");
    const flash = document.getElementById("flash");
    const playBtn = document.getElementById("playBtn");
    const speakBtn = document.getElementById("speakBtn");
    const storyText = document.getElementById("story").innerText;

    // 🎶 Play / pause background music
    playBtn.addEventListener("click", () => {
      if (bgMusic.paused) {
        bgMusic.play();
        playBtn.innerText = "⏸️ Pause Music";
      } else {
        bgMusic.pause();
        playBtn.innerText = "🎧 Play Music";
      }
    });

    // ⚡ Trigger lightning flash + thunder at end
    function triggerFlash() {
      flash.classList.add("active");
      thunder.play();
      setTimeout(() => flash.classList.remove("active"), 700);
    }

    // 🔊 Read story with deeper voice, flash near the end
    function speakStory() {
      const voices = window.speechSynthesis.getVoices();
      const voice =
        voices.find(v => v.name.toLowerCase().includes("male")) || voices[0];
      const speech = new SpeechSynthesisUtterance(storyText);
      speech.voice = voice;
      speech.lang = "en-US";
      speech.rate = 0.9;
      speech.pitch = 0.8;

      // estimate timing: flash 6s before end
      const totalTime = storyText.split(" ").length * 200; // ms estimate
      setTimeout(triggerFlash, totalTime - 6000);

      window.speechSynthesis.speak(speech);
    }

    speakBtn.addEventListener("click", speakStory);
    window.speechSynthesis.onvoiceschanged = () => {};
  </script>
</body>
</html>
